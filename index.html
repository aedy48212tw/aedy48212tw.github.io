<!doctype html>
<html lang="zh-Hant">
<head>
<meta http-equiv="refresh" content="300">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>即時氣象看板</title>
<style>
  :root{
    --bandH: 380px; /* 上半部、下半部等高控制 */
  }
  body {
    margin: 0;
    font-family: sans-serif;
    background: #0d0f17;
    color: #fff;
  }

  .dashboard {
    display: grid;
    grid-template-rows: auto auto auto; /* 上帶 / 下帶 / 跑馬燈 */
    gap: 10px;
    padding: 10px;
    min-height: 100vh;
  }

  /* 上半部 */
  .top-row {
    height: var(--bandH);
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 10px;
  }

  /* 下半部 */
  .bottom-row {
    height: var(--bandH);
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: 1fr 1fr;
    grid-template-areas:
      "thunder lightning forecast forecast weather weather weather"
      "thunder lightning forecast forecast wind temp air";
    gap: 10px;
  }

  /* 基本方框樣式 */
  .panel {
    background: #151a25;
    border: 2px solid #1f2435;
    border-radius: 6px;
    display: flex;
    flex-direction: column;
  }
  .panel h3 {
    margin: 0;
    padding: 6px 8px;
    font-size: 14px;
    background: #20253a;
    color: #ffd166;
    border-bottom: 1px solid #1f2435;
    display: flex; justify-content: space-between; align-items: center;
  }
  .edit-btn {
    background: #ffd166;
    color: #20253a;
    border: none;
    border-radius: 4px;
    padding: 2px 6px;
    font-size: 12px;
    cursor: pointer;
  }

  .panel .content {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #0d0f17;
    overflow: hidden; /* 確保圖片不超框 */
  }
  .panel .content img,
  .panel .content iframe {
    width: 100%;
    height: 100%;
    object-fit: cover; /* ✅ 保留你原始設定 */
  }

  /* scale 調整 */
  .zoom img {
    transform-origin: center center;
    transition: transform 0.3s ease;
  }
  .zoom.small img { transform: scale(2.0); } /* 放大 */
  .zoom.large img { transform: scale(0.9); } /* 縮小 */

  /* 下半部區域對應 */
  .thunder  { grid-area: thunder; }
  .lightning{ grid-area: lightning; }
  .forecast { grid-area: forecast; }
  .weather  { grid-area: weather; }
  .wind     { grid-area: wind; }
  .temp     { grid-area: temp; }
  .air      { grid-area: air; }

  /* 排行榜清單樣式 */
  .rank-list {
    list-style: none;
    margin: 0;
    padding: 8px;
    font-size: 14px;
    overflow-y: auto;
  }
  .rank-item {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
    border-bottom: 1px dashed #aaa;
  }

  /* 跑馬燈 */
  .ticker {
    display: flex;
    align-items: center;
    background: #20253a;
    border: 2px solid #1f2435;
    border-radius: 6px;
    padding: 6px 10px;
    overflow: hidden;
  }
  .ticker .warn {
    background: #ff6b6b;
    padding: 2px 6px;
    border-radius: 4px;
    margin-right: 8px;
    white-space: nowrap;
  }
  .ticker .text {
    flex: 1;
    overflow: hidden;
    position: relative;
  }
  .ticker .text .scroll {
    display: inline-block;
    padding-left: 100%; /* 從右邊開始 */
    white-space: nowrap;
    animation: marquee 15s linear infinite;
  }
  @keyframes marquee {
    0%   { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }
  .ticker .clock {
    margin-left: auto;
    white-space: nowrap;
  }

  /* ✅ RWD 手機版排版 */
  @media (max-width: 900px) {
    .top-row, .bottom-row {
      height: auto; /* 取消固定高度 */
      grid-template-columns: repeat(2, 1fr); /* 改為 2 欄 */
      grid-template-rows: auto;
    }
    .bottom-row {
      grid-template-areas: unset; /* 取消複雜區塊配置 */
    }
    .panel {
      min-height: 200px; /* 每個區塊至少有高度 */
    }
  }
</style>
</head>
<body>

<div class="dashboard">

  <!-- 上半部 -->
  <div class="top-row">
    <section class="panel rain0h"><h3>目前雨量</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/rainfall/QZJ.jpg"></div></section>
    <section class="panel rain6h"><h3>預報0-6小時</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/fcst_img/QPF_ChFcstPrecip_6_06.png"></div></section>
    <section class="panel rain12h"><h3>預報6-12小時</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/fcst_img/QPF_ChFcstPrecip_6_12.png"></div></section>
    <section class="panel rain18h"><h3>預報12-18小時</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/fcst_img/QPF_ChFcstPrecip_6_18.png"></div></section>
    <section class="panel rain24h"><h3>預報18-24小時</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/fcst_img/QPF_ChFcstPrecip_6_24.png"></div></section>

    <section class="panel rank1">
      <h3>累積雨量排行</h3>
      <ol class="rank-list">
        <li class="rank-item"><span>1 秀林</span><span>63.0</span></li>
        <li class="rank-item"><span>2 武塔</span><span>57.0</span></li>
        <li class="rank-item"><span>3 和平</span><span>57.0</span></li>
        <li class="rank-item"><span>4 和平林道</span><span>55.5</span></li>
        <li class="rank-item"><span>5 明池</span><span>55.0</span></li>
        <li class="rank-item"><span>6 龍澗</span><span>57.0</span></li>
        <li class="rank-item"><span>7 善馬陂</span><span>57.0</span></li>
        <li class="rank-item"><span>8 豐濱</span><span>55.5</span></li>
        <li class="rank-item"><span>9 蘭嶼高中</span><span>55.0</span></li>
        <li class="rank-item"><span>10 梅峰</span><span>54.0</span></li>
      </ol>
    </section>

    <section class="panel rank2">
      <h3>平均風速排行</h3>
      <ol class="rank-list">
        <li class="rank-item"><span>1 秀林</span><span>63.0</span></li>
        <li class="rank-item"><span>2 武塔</span><span>57.0</span></li>
        <li class="rank-item"><span>3 和平</span><span>57.0</span></li>
        <li class="rank-item"><span>4 和平林道</span><span>55.5</span></li>
        <li class="rank-item"><span>5 明池</span><span>55.0</span></li>
        <li class="rank-item"><span>6 龍澗</span><span>57.0</span></li>
        <li class="rank-item"><span>7 善馬陂</span><span>57.0</span></li>
        <li class="rank-item"><span>8 豐濱</span><span>55.5</span></li>
        <li class="rank-item"><span>9 蘭嶼高中</span><span>55.0</span></li>
        <li class="rank-item"><span>10 梅峰</span><span>54.0</span></li>
      </ol>
    </section>
  </div>

  <!-- 下半部 -->
  <div class="bottom-row">
    <section class="panel thunder"><h3>目前雷達</h3><div class="content zoom"><img src="https://cwaopendata.s3.ap-northeast-1.amazonaws.com/Observation/O-A0058-003.png"></div></section>
    <section class="panel lightning"><h3>即時閃電</h3><div class="content zoom small"><img src="https://www.cwa.gov.tw/Data/lightning/lightning_s.jpg"></div></section>
    <section class="panel forecast"><h3>短期天氣預報</h3><div class="content"><iframe width="100%" height="100%" src="https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=mm&metricTemp=%C2%B0C&metricWind=kt&zoom=6&overlay=rain&product=ecmwf&level=surface&lat=23.554&lon=120.942&pressure=true&play=1" frameborder="0"></iframe></div></section>

    <section class="panel weather">
      <h3>
        天氣概況
        <button class="edit-btn" onclick="editWeather()">✏️ 手動更新</button>
      </h3>
      <div class="content" id="weatherContent" style="padding:10px">
        １２日至１４日各地為多雲到晴，僅恆春半島及東南部地區有零星短暫陣雨，午後西半部地區及其他山區有局部短暫雷陣雨，山區並有局部大雨發生的機率，清晨西半部地區亦有零星短暫陣雨。
      </div>
    </section>

    <section class="panel wind"><h3>目前均風</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/windspeed/2025-09-12_1500.GWD2.png"></div></section>
    <section class="panel temp"><h3>目前溫度</h3><div class="content"><img src="https://cwaopendata.s3.ap-northeast-1.amazonaws.com/Observation/O-A0038-001.jpg"></div></section>
    <section class="panel air"><h3>衛星雲圖</h3><div class="content"><img src="https://www.cwa.gov.tw/Data/satellite/TWI_IR1_MB_800/TWI_IR1_MB_800.jpg"></div></section>
  </div>

  <!-- 跑馬燈 -->
  <div class="ticker">
    <span class="warn">豪雨特報</span>
    <div class="text">
      <span class="scroll" id="marqueeText">今天台中山區及南投山區有局部豪雨，請注意安全。</span>
    </div>
    <div class="clock" id="clock">--:--:--</div>
    <button class="edit-btn" onclick="editMarquee()" style="margin-left: 10px;">✏️ 手動更新</button>
  </div>
</div>

<script>
  function tick() {
    const el = document.getElementById('clock');
    const now = new Date();
    const pad = n => String(n).padStart(2,'0');
    el.textContent = `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
  }
  tick();
  setInterval(tick, 1000);

  window.addEventListener('DOMContentLoaded', () => {
    const weather = localStorage.getItem('weatherContent');
    const marquee = localStorage.getItem('marqueeText');
    if (weather) document.getElementById('weatherContent').textContent = weather;
    if (marquee) document.getElementById('marqueeText').textContent = marquee;
  });

  function editWeather() {
    const el = document.getElementById('weatherContent');
    const current = el.textContent;
    const input = prompt("請輸入天氣概況內容：", current);
    if (input !== null) {
      el.textContent = input;
      localStorage.setItem('weatherContent', input);
      alert('✅ 已更新並儲存');
    }
  }

  function editMarquee() {
    const el = document.getElementById('marqueeText');
    const current = el.textContent;
    const input = prompt("請輸入跑馬燈內容：", current);
    if (input !== null) {
      el.textContent = input;
      localStorage.setItem('marqueeText', input);
      alert('✅ 已更新並儲存');
    }
  }
</script>
</body>
</html>
